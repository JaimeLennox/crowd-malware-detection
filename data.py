
def create_data_dict(data_file):
    with open(data_file) as file:
        lines = [line.rstrip(';\r\n') for line in file]

    data_list = map(lambda x: x.split(';'), lines)
    data_dict = {}

    for data in data_list:
        data_dict[data[0]] = map(int, data[1:])

    return data_dict


def count_antivirus_engines(engine_file):
    count = 0

    with open(engine_file) as engines:
        for line in engines:
            if line.strip():
                count += 1

    return count


def get_malware_proportions(result_values):
    return result_values.count(0), result_values.count(1)


def correct_count(results, type_dict):
    return sum([1 if results[result] == type_dict[result] else 0 for result in results])


def get_ransomware_data():
    return get_data(
        'datasets/ransomware/AVnames.txt',
        'datasets/ransomware/matrix-antivirus-ransomware.txt',
        'datasets/ransomware/matrix-antivirus-goodware.txt'
    )


def get_large_data():
    return get_data(
        'datasets/large/engines.txt',
        'datasets/large/matrix-antivirus-malware.txt',
        'datasets/large/matrix-antivirus-goodware.txt'
    )


def get_data(engine_file, malware_file, goodware_file):
    engine_count = count_antivirus_engines(engine_file)
    ransomware_dict = create_data_dict(malware_file)
    goodware_dict = create_data_dict(goodware_file)

    data_dict = dict(ransomware_dict.items() + goodware_dict.items())

    type_dict = dict([(key, 1) for key in ransomware_dict] + [(key, 0) for key in goodware_dict])

    return engine_count, data_dict, type_dict

