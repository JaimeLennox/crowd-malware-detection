import data


# returns a dict of hash to vote (0 for goodware,1 for malware)
def threshold(ransomware_dict, malware_threshold):
    results = {}

    for hash in ransomware_dict:
        report = ransomware_dict[hash]

        if report.count(1) >= malware_threshold:
            results[hash] = 1
        else:
            results[hash] = 0

    return results


# dynamic threshold of half the number of labelling engines
def majority_vote(ransomware_dict):
    results = {}

    for hash in ransomware_dict:
        report = ransomware_dict[hash]

        malware_threshold = (report.count(0) + report.count(1)) / 2

        if report.count(1) >= malware_threshold:
            results[hash] = 1
        else:
            results[hash] = 0

    return results


if __name__ == "__main__":
    engine_count, data_dict, type_dict = data.get_large_data()

    # Threshold
    malware_threshold = 5

    results = threshold(data_dict, malware_threshold)
    accuracy = data.correct_count(results, type_dict) / float(len(data_dict))

    print "Threshold:", malware_threshold
    print "Accuracy:", accuracy

    print

    # Majority Vote
    results = majority_vote(data_dict)
    accuracy = data.correct_count(results, type_dict) / float(len(data_dict))

    print "Majority Vote:"
    print "Accuracy:", accuracy


