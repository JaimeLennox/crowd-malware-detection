import data


# returns a dict of hash to vote (0 for goodware,1 for malware)
def threshold(ransomware_dict, malware_threshold):
    results = {}

    for hash in ransomware_dict:
        report = ransomware_dict[hash]

        if report.count(1) >= malware_threshold:
            results[hash] = 1
        else:
            results[hash] = 0

    return results


def majority_vote(ransomware_dict, no_antivirus_engines):
    return threshold(ransomware_dict, no_antivirus_engines / 2)


def get_malware_proportions(result_values):
    return result_values.count(0), result_values.count(1)


if __name__ == "__main__":
    engine_count, ransomware_dict, goodware_dict = data.get_data()

    malware_threshold = 5

    ransomware_results = threshold(ransomware_dict, malware_threshold)
    goodware_results = threshold(goodware_dict, malware_threshold)

    ransomware_zeroes, ransomware_ones = get_malware_proportions(ransomware_results.values())
    goodware_zeroes, goodware_ones = get_malware_proportions(goodware_results.values())

    malware_error = float(ransomware_zeroes) / (ransomware_zeroes + ransomware_ones)
    goodware_error = float(goodware_ones) / (goodware_zeroes + goodware_ones)

    print "malware error:", malware_error
    print "goodware error:", goodware_error

